<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Interactive Tax Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    input, select, button { padding: 0.5rem; margin: 0.5rem 0; }
    .result { margin-top: 1rem; }
    table { border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; }
  </style>
</head>
<body>
  <h2>Interactive Tax Calculator</h2>
  <label for="income">Enter Your Income (₹):</label>
  <input type="number" id="income" placeholder="e.g., 1800000"><br>
  
  <label for="type">Select Taxpayer Type:</label>
  <select id="type">
    <option value="nonSalaried">Non-Salaried (Nil up to ₹12,00,000)</option>
    <option value="salaried">Salaried (Nil up to ₹12,75,000)</option>
  </select><br>
  
  <button onclick="calculateTax()">Calculate Tax</button>
  
  <div class="result" id="result"></div>
  
  <script>
    // Pre-Budget slabs (Before 2025)
    function taxPreBudget(income) {
      let tax = 0;
      // Slab definitions:
      if (income > 300000) {
        let slabAmount = Math.min(income, 700000) - 300000;
        tax += slabAmount * 0.05;
      }
      if (income > 700000) {
        let slabAmount = Math.min(income, 1000000) - 700000;
        tax += slabAmount * 0.10;
      }
      if (income > 1000000) {
        let slabAmount = Math.min(income, 1200000) - 1000000;
        tax += slabAmount * 0.15;
      }
      if (income > 1200000) {
        let slabAmount = Math.min(income, 1500000) - 1200000;
        tax += slabAmount * 0.20;
      }
      if (income > 1500000) {
        tax += (income - 1500000) * 0.30;
      }
      return tax;
    }
    
    // Revised slabs (After 2025)
    function taxRevised(income) {
      let tax = 0;
      if (income > 400000) {
        let slabAmount = Math.min(income, 800000) - 400000;
        tax += slabAmount * 0.05;
      }
      if (income > 800000) {
        let slabAmount = Math.min(income, 1200000) - 800000;
        tax += slabAmount * 0.10;
      }
      if (income > 1200000) {
        let slabAmount = Math.min(income, 1600000) - 1200000;
        tax += slabAmount * 0.15;
      }
      if (income > 1600000) {
        let slabAmount = Math.min(income, 2000000) - 1600000;
        tax += slabAmount * 0.20;
      }
      if (income > 2000000) {
        let slabAmount = Math.min(income, 2400000) - 2000000;
        tax += slabAmount * 0.25;
      }
      if (income > 2400000) {
        tax += (income - 2400000) * 0.30;
      }
      return tax;
    }
    
    // Function to apply marginal relief for incomes near the threshold.
    function applyMarginalRelief(calculatedTax, income, threshold) {
      let excess = income - threshold;
      // If the computed tax exceeds the excess (small increment above threshold), cap it.
      return calculatedTax > excess ? excess : calculatedTax;
    }
    
    function calculateTax() {
      // Read user inputs
      let income = parseFloat(document.getElementById("income").value);
      let taxpayerType = document.getElementById("type").value;
      
      if (isNaN(income)) {
        document.getElementById("result").innerHTML = "Please enter a valid income.";
        return;
      }
      
      // Set nil tax threshold based on taxpayer type
      let nilThreshold = taxpayerType === "salaried" ? 1275000 : 1200000;
      
      // Calculate tax under both regimes
      // For simplicity, assume that marginal relief applies only if income is near the threshold
      // (i.e. income <= nilThreshold + small margin, say ₹75,000 extra)
      
      // Pre-Budget Calculation:
      let taxPre = taxPreBudget(income);
      if (income <= nilThreshold + 75000) {
        taxPre = applyMarginalRelief(taxPre, income, nilThreshold);
      }
      
      // Revised Calculation:
      let taxRev = taxRevised(income);
      if (income <= nilThreshold + 75000) {
        taxRev = applyMarginalRelief(taxRev, income, nilThreshold);
      }
      
      // Effective tax rate = (Tax Liability / Income) * 100
      let effectiveRatePre = ((taxPre / income) * 100).toFixed(2);
      let effectiveRateRev = ((taxRev / income) * 100).toFixed(2);
      
      // Display the results in a table
      let output = `
        <h3>Results for a Taxable Income of ₹${income.toLocaleString()}</h3>
        <table>
          <tr>
            <th>Parameter</th>
            <th>Before 2025 (Pre‑Budget)</th>
            <th>After 2025 (Revised)</th>
          </tr>
          <tr>
            <td>Total Tax Liability (₹)</td>
            <td>${taxPre.toLocaleString()}</td>
            <td>${taxRev.toLocaleString()}</td>
          </tr>
          <tr>
            <td>Effective Tax Rate (%)</td>
            <td>${effectiveRatePre}%</td>
            <td>${effectiveRateRev}%</td>
          </tr>
        </table>
      `;
      document.getElementById("result").innerHTML = output;
    }
  </script>
</body>
</html>
